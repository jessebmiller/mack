setopt prompt_subst
autoload -U colors
colors

function git_ref() {
    # Show the branch or whatever we are on if we are in a git repo
    local ref
    ref=$(command git symbolic-ref --short HEAD 2> /dev/null) || \
        ref=$(command git rev-parse --short HEAD 2> /dev/null) || \
        return 0
    echo "$ref"
    return 0
}

GIT_PROMPT_PREFIX="on "
GIT_PROMPT_POSTFIX=""

function git_prompt() {
    local GIT_REF="$(git_ref)"
    if [[ -z $GIT_REF ]]; then
        return 0
    fi
    echo "$GIT_PROMPT_PREFIX$GIT_REF$GIT_PROMPT_POSTFIX"
    return 0
}

PROMPT='
%n at %m in %~ $(git_prompt)
%(?..%{$fg[red]%})‚ùØ%{$reset_color%} '
